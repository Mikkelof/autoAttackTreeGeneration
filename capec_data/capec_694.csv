ID,Name,Abstraction,Status,Description,Alternate Terms,Likelihood Of Attack,Typical Severity,Related Attack Patterns,Execution Flow,Prerequisites,Skills Required,Resources Required,Indicators,Consequences,Mitigations,Example Instances,Related Weaknesses,Taxonomy Mappings,Notes
694,System Location Discovery,Standard,Stable,"An adversary collects information about the target system in an attempt to identify the system's geographical location. Information gathered could include keyboard layout, system language, and timezone. This information may benefit an adversary in confirming the desired target and/or tailoring further attacks.",,High,Very Low,::NATURE:ChildOf:CAPEC ID:169::,"::STEP:1:PHASE:Explore:DESCRIPTION:[System Locale Information Discovery] The adversary examines system information from various sources such as registry and native API functions and correlates the gathered information to infer the geographical location of the target system:TECHNIQUE:Registry Query: Query the registry key HKEY_LOCAL_MACHINESYSTEMCurrentControlSetControlContentIndexLanguageLanguage_Dialect on Windows to obtain system language, ComputerHKEY_CURRENT_USERKeyboard LayoutPreload to obtain the hexadecimal language IDs of the current user's preloaded keyboard layouts, and ComputerHKEY_LOCAL_MACHINESYSTEMCurrentControlSetControlTimeZoneInformation to obtain the system timezone configuration:TECHNIQUE:Native API Requests: Parse the outputs of Windows API functions GetTimeZoneInformation, GetUserDefaultUILanguage, GetSystemDefaultUILanguage, GetKeyboardLayoutList and GetUserDefaultLangID to obtain information about languages, keyboard layouts, and timezones installed on the system or on macOS or Linux systems, query locale to obtain the $LANG environment variable and view keyboard layout information or use timeanddatectl status to show the system clock settings.:TECHNIQUE:Read Configuration Files: For macOS and Linux-based systems, view the /etc/vconsole.conf file to get information about the keyboard mapping and console font.::",::The adversary must have some level of access to the system and have a basic understanding of the operating system in order to query the appropriate sources for relevant information.::,::SKILL:The adversary must know how to query various system sources of information respective of the system's operating system to obtain the relevant information.:LEVEL:Low::,"::The adversary requires access to the target's operating system tools to query relevant system information. On windows, registry queries can be conducted with powershell, wmi, or regedit. On Linux or macOS, queries can be performed with through a shell.::",,::SCOPE:Confidentiality:TECHNICAL IMPACT:Read Data::,"::To reduce the amount of information gathered, one could disable various geolocation features of the operating system not required for system operation.::",,::497::,TAXONOMY NAME:ATTACK:ENTRY ID:1614:ENTRY NAME:System Language Discovery::,,
